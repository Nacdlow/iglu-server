{{template "base/head" .}}
{{template "base/nav" .}}
{{template "base/flash" .}}

<div class="container">
  <div class="mobhide">
    <div class="row align-items-center justify-content-center pt-3 pb-1">
      <div class="col-2">
        <a class="fas fa-arrow-circle-left fa-2x text-left" href="/rooms"></a>
      </div>
      <div class="col-8">
        <div class="d-flex align-items-center justify-content-center">
          <h2 class="text-center mb-0 pr-3">{{$.Room.RoomName}}</h2>
        <div class="card bodycolor circle-1 d-flex {{if gt $.Room.CurrentTemp 25}} circle-red
        {{else if gt $.Room.CurrentTemp 22}} circle-orange{{end}}">
          <div class="card-body d-flex justify-content-center align-items-center text-center">
            <div class="row">
              <div class="col-12 pb-0" style="font-size: x-small;">Temp</div>
              <div class="col-12">
            <h3 class="white-text">{{$.Room.CurrentTemp}}<small>Â°C</small></h3>
              </div>
            </div>
          </div>
        </div>
        </div>
        
      </div>
    <div class="col-2 d-flex justify-content-end align-items-center">
      <a class="btn btn-new-1 btn-phat btn-border-iglu navcolor text-center p-3 m-0 btn-lg" 
      href="{{if .IsSpecificRoom}}/add/device/{{.Room.RoomID}}{{else}}/add{{end}}">
        Add Device</a>
      </div>
    </div>
    
  </div>


    <!-- devices tabs-->
    <div class="nav nav-tabs d-flex justify-content-center pt-4 scrollmenu" id="myTab" role="tablist">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
          aria-selected="true"><i class="far fa-lightbulb fa-2x"></i><br>Lights</a>
        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
          aria-selected="false"><i
            class="fas fa-volume-up fa-2x"></i><br>Speakers</a>
        <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact"
          aria-selected="false"><i
            class="far fa-snowflake fa-2x"></i><br>Temperature</a>
        <a class="nav-link" id="tv-tab" data-toggle="tab" href="#tv" role="tab" aria-controls="tv" aria-selected="false">
      <i class="fas fa-tv fa-2x"></i><br>TV</a> 
    </div>

    <!-- /devices tabs-->

    <!-- devices' tab content (the devices cards)-->

    <div class="tab-content" id="myTabContent">

      <!--light device tab cards-->
      <div class="tab-pane show active" id="home" role="tabpanel" aria-labelledby="home-tab">
        <div class="row justify-content-center p-3">
          {{range .Devices}}
          {{if and (eq .Type 0) (eq .RoomID $.Room.RoomID)}}
          <div class="col-lg-4 col-md-6 col-12 pb-4">
            {{template "cards/light" .}}
          </div>
          {{end}}
          {{end}}
        </div>
      </div>
      <!--/light device tab cards-->

      <!--speaker device tab cards-->
      <div class="tab-pane" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="row justify-content-center p-3">

          {{range .Devices}}{{if and (eq .Type 3) (eq .RoomID $.Room.RoomID)}}
          <!--Card 1-->
          <div class="col-lg-4 col-md-6 col-12 pb-4">
            {{template "cards/speaker" .}}
          </div>
          {{end}}{{end}}
        </div>
      </div>
      <!--/speaker device tab cards-->

      <!--temp device tab cards-->
      <div class="tab-pane" id="contact" role="tabpanel" aria-labelledby="contact-tab">

        <div class="row justify-content-center p-3">
          {{range .Devices}}{{if and (eq .Type 1) (eq .RoomID $.Room.RoomID)}}
          <!--Card 1-->
          <div class="col-lg-4 col-md-6 col-12 pb-4">
            {{template "cards/temp" .}}
          </div>
          {{end}}{{end}}
        </div>
      </div>

      <!--tv device tab cards-->
      <div class="tab-pane" id="tv" role="tabpanel" aria-labelledby="contact-tab">

        <div class="row justify-content-center p-3">
          {{range .Devices}}{{if and (eq .Type 2) (eq .RoomID $.Room.RoomID)}}
          <!--Card 1-->
          <div class="col-lg-4 col-md-6 col-12 pb-4">
            {{template "cards/tv" .}}
          </div>
          {{end}}{{end}}
        </div>
      </div>
      <!--/tv device tab cards-->

    </div>
</div>

<!-- move Device -->
<div class="modal fade" id="moveDevice" tabindex="-1" role="dialog"
	aria-labelledby="moveDevice" aria-hidden="true">

	<!-- Change class .modal-sm to change the size of the modal -->
	<div class="modal-dialog modal-lg" role="document">
		
		<div class="modal-content" style="background-color:   #121212;">
			<div class="modal-header">
				<h4 class="modal-title w-100 white-text" id="moveDevice">Move Device to:
        </h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
      </div>
      <div class="row justify-content-center pt-3 pb-3 p-3">
        {{range .Rooms}}{{if not (eq .RoomID $.Room.RoomID)}}
    <div class="col-lg-4">
      <a class="room-{{.RoomID}}" onclick="move({{.RoomID}})">
      <div class="card mr-lg-0 mb-4" id="moveRoomLink">
        <div class="card-body">
          <div class="row">
            <div class="col-8">
              <h2 id="name-{{.RoomID}}">{{.RoomName}}</h2>
            </div>
            <div class="col-4 d-flex align-items-center justify-content-end">
              <i class="{{if eq .RoomType 0}}fas fa-couch{{else if eq .RoomType 1}}fas fa-bed{{else if eq .RoomType 2}}
          fas fa-coffee{{else if eq .RoomType 3}}fas fa-utensils{{else if eq .RoomType 4}}fas fa-bath{{else if eq .RoomType 5}}
          fas fa-door-open{{else if eq .RoomType 6}}fas fa-toolbox{{else if eq .RoomType 7}}fas fa-socks{{else if eq .RoomType 8}}
          fas fa-warehouse{{else if eq .RoomType 9}}fas fa-user{{end}} fa-2x"></i>
          </div>
        </div>
      </div>
    </div>
  </a>
  </div>
  {{end}}{{end}}
</div>
			<div class="text-center"> 
				<button type="button" class="btn btn btn-danger-new bodycolor btn-phat" data-dismiss="modal">Cancel</button>
				<button type="submit" data-dismiss="modal" class="btn btn-success-new bodycolor btn-phat" id="move-{{.DeviceID}}"
          onclick="$.get('/move_device/{{.DeviceID}}');reload();">Move Device</button>
          
			</div>
	</div>
</div>
</div>
<!-- /move Device -->

{{template "base/scripts" .}}
<script>
	function update() {
    {{range .Devices}}
    $(" #labeldiv-{{.DeviceID}}").load(location.href + " #labeldiv-{{.DeviceID}}>*", "");
    $(" #footerdiv-{{.DeviceID}}").load(location.href + " #footerdiv-{{.DeviceID}}>*", "");
    $(" #favediv-{{.DeviceID}}").load(location.href + " #favediv-{{.DeviceID}}>*", "");
    $(" #sliderdiv-{{.DeviceID}}").load(location.href + " #sliderdiv-{{.DeviceID}}>*", "");
    //$("#tempdiv-{{.RoomID}}").load(location.href + " #tempdiv-{{.RoomID}}>*", "");
    {{end}}
	}
	update(); // This will run on page load
	setInterval(function () {
		update() // this will run after every 1 seconds
	}, 1000);

  function move(id){

  }
</script>
{{template "base/tabnav" .}}
{{template "base/footer" .}}
