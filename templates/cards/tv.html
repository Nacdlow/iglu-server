<div class="card w-100">
	<div class="card-header">

		<div class="row">
			<div class="col"></div>

			<div class="">
				<i id="lock-{{.DeviceID}}"></i>
				<h5 class="card-title text-center justify-content-center mb-0" id="name-{{.DeviceID}}">{{.Description}}
				</h5>
			</div>

			<div class="col text-right">
				<a class="p-0" id="navbarDropdownMenuLink-333" data-toggle="dropdown" aria-haspopup="true"
					aria-expanded="false">
					<i class="fas fa-ellipsis-h"></i>
				</a>
				<div class="dropdown-menu dropdown-menu-right dropdown-default text-center"
					aria-labelledby="navbarDropdownMenuLink-333">
					<a class="dropdown-item {{if .IsFave}}red-text{{else}}black-text{{end}}" href="#"
						id="fave-{{.DeviceID}}" onclick="$.get('/toggle_fave/{{.DeviceID}}');reload();">
						{{if .IsFave}}Un-favourite{{else}}Favourite{{end}} <i class="fas fa-heart red-text"></i></a>
					<a class="dropdown-item black-text" href="#" onclick="edit({{.DeviceID}});">Edit</a>
					<a class="dropdown-item black-text" href="#" id="move-{{.DeviceID}}" data-toggle="modal"
						data-target="#moveDevice" onclick="passDevID({{.DeviceID}})">Move</a>
					<a class="dropdown-item black-text" href="#" id="remove-{{.DeviceID}}" data-toggle="modal"
						data-target="#removeDevice-{{.DeviceID}}">Delete</a>
				</div>
			</div>
		</div>
	</div>

	<div class="card-body">
		<!-- switch -->
		<div class="col justify-content-center align-items-center d-flex" id="toggleHide-{{.DeviceID}}">
			<div class="labeldiv-{{.DeviceID}}" id="labeldiv-{{.DeviceID}}">
				<a class="fas fa-power-off pb-1 {{if .Status}}green-text{{else}}red-text{{end}}" href="#"
					style="color: black; font-size: 4em;" onclick="$.get('/toggle_device/{{.DeviceID}}');update();"></a>
				<label class="col justify-content-center d-flex mb-0">{{if .Status}}On{{else}}Off{{end}}</label>
			</div>
			<!--/switch -->
		</div>
		<div id="button-{{.DeviceID}}" class="button-{{.DeviceID}} text-center justify-content-center d-flex"></div>
	</div>
	<div class="footerdiv-{{.DeviceID}}" id="footerdiv-{{.DeviceID}}">
		<div class="card-footer" {{if .Status}}style="background-color: #A8FFA8;"
			{{else}}style="background-color: #CDCDCD;" {{end}}>
			<p class="mb-0">{{if .Status}}Time On: 30 minutes{{else}}Disconnected{{end}}</p>
		</div>
	</div>
</div>

<!-- Remove Device -->
<div class="modal fade" id="removeDevice-{{.DeviceID}}" tabindex="-1" role="dialog"
	aria-labelledby="removeDevice-{{.DeviceID}}" aria-hidden="true">

	<!-- Change class .modal-sm to change the size of the modal -->
	<div class="modal-dialog modal-sm" role="document">


		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title w-100 black-text" id="removeDevice">Are you sure you want to remove this device?
				</h4>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-footer justify-content-center">
				<button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</button>
				<button type="submit" data-dismiss="modal" class="btn btn-primary btn-sm" id="remove-{{.DeviceID}}"
					onclick="$.get('/remove_device/{{.DeviceID}}');reload();">Remove Device</button>
			</div>
		</div>
	</div>
</div>
<!-- /Remove Device -->
<script>
	function edit(id) {//swaps room title with an input field and changes the button to a save button.
		var toggleDiv = document.getElementById("toggleHide-" + id);
		toggleDiv.style.display = "none";
		var deviceName = document.getElementById("name-" + id);
		var inputField = document.createElement("input");
		inputField.setAttribute('id', 'new-' + id);
		inputField.setAttribute('class', 'black-text navcolor white-text');
		inputField.setAttribute('style', 'border: 2px solid white; opacity: 80%; border-radius: 50px; height: 35px; width: 200px; color: white;');
		inputField.setAttribute('placeholder', " Device Name:");
		deviceName.parentNode.replaceChild(inputField, deviceName);

		var viewButton = document.getElementById("button-" + id);
		var saveButton = document.createElement("a");
		saveButton.setAttribute('id', 'saveButton-' + id);
		saveButton.setAttribute('class', 'btn-new-1 text-center p-4 white-text justify-content-center pt-3 d-flex');
		saveButton.setAttribute('style', 'background-color: #3ddb75;');
		saveButton.setAttribute('onClick', 'postChanges(' + id + ');');
		saveButton.innerHTML = "Save";
		viewButton.parentNode.replaceChild(saveButton, viewButton);

		var lock = document.getElementById("lock-" + id);
		var close = document.createElement("a");
		close.setAttribute('id', 'close-' + id);
		close.setAttribute('class', 'fas fa-times-circle white-text pr-2');
		close.setAttribute('onClick', 'reload();');
		lock.parentNode.replaceChild(close, lock);
	}

	function postChanges(id) {
		var newName = document.getElementById("new-" + id).value;
		console.log(newName)
		$.get('/change_device/' + id + '/' + newName);
		reload();
	}
</script>
